# React Block Puzzle

React TypeScriptで実装されたクラシックなブロックパズルゲームです。

## ゲーム概要

落下するテトリミノ（ブロックピース）を操作して、横一列を埋めてラインを消していくパズルゲームです。ラインを消すことで得点を獲得し、より高いレベルに挑戦できます。

## 操作方法

| キー | 動作 |
|------|------|
| ←/→ | 左右移動 |
| ↑ | 回転 |
| ↓ | ソフトドロップ（加速落下） |
| Escape | ポーズ |

## ゲームメカニクス

### テトリミノ（ブロックピース）
7種類の異なる形状のテトリミノが登場します：
- **I型** (水色): 4マス直線
- **O型** (黄色): 2×2の正方形
- **T型** (紫): T字型
- **S型** (緑): S字型
- **Z型** (赤): Z字型
- **J型** (青): L字型（左向き）
- **L型** (オレンジ): L字型（右向き）

### 基本ルール
- テトリミノは画面上部から自動的に落下
- プレイヤーは落下中のテトリミノを左右移動・回転可能
- テトリミノが着地すると固定される
- 横一列が完全に埋まるとその列が消去される
- 画面上部までブロックが積み上がるとゲームオーバー

### ロックディレイ
- テトリミノが着地しても1秒間は固定されない
- この間に左右移動や回転が可能
- 移動や回転に成功するとロックタイマーがリセット

### ウォールキック（壁蹴り）
- 回転時に壁や他のブロックに衝突する場合、自動的に位置を調整
- Super Rotation System (SRS)に基づく実装

## スコアシステム

### ライン消去得点
| 消去ライン数 | 得点計算 | レベル1での得点 |
|-------------|----------|----------------|
| 1ライン | 100 × レベル | 100点 |
| 2ライン | 300 × レベル | 300点 |
| 3ライン | 500 × レベル | 500点 |
| 4ライン | 800 × レベル | 800点 |

### レベルアップ
- 10ライン消去ごとにレベルが1上昇
- レベルが上がると落下速度が増加

### 落下速度
レベルに応じて落下間隔が短縮：
- レベル1: 800ms
- レベル5: 600ms
- レベル10: 350ms
- レベル15: 200ms
- レベル20以上: 100ms

## 技術仕様

### 使用技術
- **フレームワーク**: React 19
- **言語**: TypeScript
- **ビルドツール**: Vite
- **スタイリング**: CSS Modules
- **テスト**: Vitest, React Testing Library

### プロジェクト構造
```
src/
├── components/     # UIコンポーネント
│   ├── GameBoard.tsx      # ゲームボード（10×20グリッド）
│   ├── ControlPanel.tsx   # 操作パネル
│   ├── ScorePanel.tsx     # スコア表示
│   ├── NextPiecePreview.tsx # 次のピース表示
│   └── GameOverScreen.tsx # ゲームオーバー画面
├── hooks/          # カスタムフック
│   ├── useGameState.ts    # ゲーム状態管理
│   ├── useKeyboardInput.ts # キーボード入力
│   └── useGameLoop.ts    # ゲームループ
├── services/       # ゲームロジック
│   ├── collisionDetector.ts  # 衝突判定
│   ├── lineClearing.ts      # ライン消去
│   ├── movementController.ts # 移動・回転制御
│   └── tetriminoGenerator.ts # テトリミノ生成
└── types/          # 型定義
    ├── board.ts    # ボード関連
    ├── game.ts     # ゲーム状態
    └── tetrimino.ts # テトリミノ
```

### ゲームボード
- サイズ: 10列 × 20行
- 各セルは色と塗りつぶし状態を保持
- 配列ベースの2次元グリッド実装

### 状態管理
- React Hooksによる状態管理
- ゲーム状態: idle | playing | paused | gameOver
- useReducerパターンでゲーム状態を一元管理

## セットアップ

### 必要要件
- [mise](https://mise.jdx.dev/) - 開発環境管理ツール
- Node.js LTS (v22) - miseで自動インストール
- pnpm v10.16.1 - miseで自動インストール

### mise を使った環境構築
```bash
# mise をインストール (まだインストールしていない場合)
curl https://mise.run | sh

# プロジェクトディレクトリで開発環境を有効化
mise trust
mise install

# 自動的に Node.js LTS と pnpm 10.16.1 がインストールされます
```

### インストール
```bash
pnpm install
```

### 開発サーバー起動
```bash
pnpm dev
```

### ビルド
```bash
pnpm build
```

### テスト実行
```bash
pnpm test
```

### npm を使う場合（代替手段）
miseを使わない場合は、以下の要件を手動でインストールしてください：
- Node.js 22以上
- npm または yarn

```bash
# npm を使う場合
npm install
npm run dev
npm run build
npm test
```

## ゲーム特徴

- **レスポンシブデザイン**: 様々な画面サイズに対応
- **スムーズな操作**: キーリピート対応で快適な操作性
- **アニメーション**: ライン消去時のビジュアルエフェクト
- **次のピースプレビュー**: 戦略的なプレイが可能
- **ポーズ機能**: いつでもゲームを一時停止可能

## ライセンス

MIT

## 注意事項

このプロジェクトは教育目的で作成されています。商用利用の際は、ゲームメカニクスに関する知的財産権を尊重してください。